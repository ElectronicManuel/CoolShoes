MODUL 326 PROJEKT ABestellStatus@CoolShoes1AUSGANGSLAGEDie Firma CoolShoesbietet in einem Internet-Shop Schuhe an.Der WEB-Shop ist gut aufgebaut und wird rege benutzt. Die Kunden bemängeln aber, dass sie keinen Bestellstatus haben.Im Projekt BestellStatus@CoolShoessoll ein solches Zusatzsystem erstellt wer-den.Hinweis:Die Shop-Funktionalität muss nicht programmiert werden. Diese wird nur zum besseren Verständnis jeweils erwähnt.2ANFORDERUNGSSPEZIFIKATION2.1SystemübersichtDer WEB-Shop von CoolShoesbietet die übliche Funktionalität an. Ein Benutzer muss sich vor dem Kauf registrieren und seine Kontaktdaten angeben. Danach kann er einkaufen. Bei einem Einkauf kann er mehrere Produkte im Warenkorb ablegen und am Ende den Kauf bestätigen. Die Zahlung erfolgt mittels Kreditkarte oder über Paypal. Die Lieferung durch CoolShoeserfolgt mit unterschiedlichen Partner wie z.B. DHL, Post usw.Jeder Auftrag erhält eine eindeutige Transaktionsnummer / Bestellnummer. Über diese Nummer kann die Bestellung bis hin zur Bezahlung der Rechnung und dar-über hinaus auch zu allfälligen Reklamationen verfolgt werden. Diese Nummer ist auch Teil des neuen Teilsystem BestellStatus@CoolShoes2.2Abläufe und FunktionenJede Bestellung wird durch eine Transaktionsnummer / Bestellnummer eindeutig identifiziert. Diese Nummer wird durch das Bestellsystem generiert und dem Auftrag zugewiesen. 2.2.1Auftrag aufbereitenSobald im Vertrieb die Bestellung geprüft wird, muss der Mitarbeiterim System den Bestellstatus auf ‘Auftrag aufbereiten‘ stellen.Ist erkennbar, dass der Auftrag nicht als Ganzes bearbeitbar ist (z.B. fehlt ein Artikel im Lager), muss der Mitarbeiter einen Vermerk setzen. Somit kann das System der Transaktionsnummer einen Zusatz A..Z beifügen (wir gehen davon aus, dass ein einzelner Auftrag nicht in 24 Teilaufträgen erledigt wird)Kann ein Auftrag nicht als Ganzes ausgelöst werden, muss der Mitarbeiter für die verspäteten Teilaufträge den Status auf ‘Teilauftrag verspätet‘ setzen und das mut-massliche Datum der Lieferung festhalten.2.2.2AuftragrüstenIst die Bestellung aufbereitet, wird der Auftrag gerüstet. Im Lager werden die bestell-ten Produkte zusammengestellt. Der Lagermitarbeiter erhält immer einen vollständig 
2Bildungszentrum Zürichsee ∙Alte Landstrasse 40 ∙8810 Horgenhorgen@bzzuerichsee.ch ∙www.bzzuerichsee.chrüstbaren Auftrag vom Vertrieb, d.h. dass Teilaufträge in mehreren Sequenzen ab-gearbeitet werden.Der Lagermitarbeiter stellt nach dem Rüsten den Status der Bestellung auf ‘Auftrag versandbereit‘. 2.2.3Auftrag ausliefernNach dem Rüsten ist der Auftrag versandbereit und wird einem Versandpartner zur Lieferung übergeben.Der Versandpartner ist dafür verantwortlich, dass der Status korrekt nachgeführt wird. Konkret muss er zwei Stati eintragen, nämlich ‘Auftrag abgeholt‘ und ‘Auftrag geliefert‘.Der erste Status meint, dass der Versandpartner die Lieferungbei CoolShoesab-holt und in sein eigenes Verteilzentrum bringt.Der zweite Status wird gesetzt, sobald die Lieferung das Verteilzentrum verlässt und sich somit auf dem Weg zum Kunden befindet.2.2.4Satus anschauenDer Kunde kann im WEB-Shop jederzeit den aktuellen Status seines Auftrags bzw. der Teilaufträge nachsehen.2.2.5HistoryFür CoolShoesmuss es jederzeit möglich sein, die Stati eines Auftrags als History zu betrachten.Wird ein Auftrag in Teilaufträge unterteilt, müssen alle Teilaufträge mit deren Stati aufgelistet werden.2.3DatenFür jedenAuftragmuss zu jeder Zeit ein Status gesetzt sein; mit Datum der Bear-beitung und Namen des Bearbeiters.Wird ein Auftrag in mehrere Teilaufträge unterteilt, sind die Daten pro Teilauftrag zu setzen. Zudem muss bei Aufträgen, die sich verspäten, der mutmassliche Lieferter-min angegeben werden.2.4Benutzerschnittstellen2.4.1BestellungBei der Bestellung muss der Kunde keine besonderen Vorkehrungen treffen, um den Status der Bestellung auf ‚‘Auftrag bestellt‘ zu setzen. Dies erfolgt aus der WEB-Anwendung heraus.2.4.2VertriebImVertrieb wird der Status entsprechend der Beschreibung festgelegt. Der Auftrag wird dabei über die Transaktionsnummer / Bestellnummer identifiziert.2.4.3LagerIm Lager wird der Status entsprechend der Beschreibung festgelegt. Der Auftrag wird dabei über die Transaktionsnummer / Bestellnummer identifiziert.2.4.4LieferantDer Lieferant passt den Status entsprechend der Beschreibung an. Der Auftrag wird dabei über die Transaktionsnummer / Bestellnummer identifiziert.
3Bildungszentrum Zürichsee ∙Alte Landstrasse 40 ∙8810 Horgenhorgen@bzzuerichsee.ch ∙www.bzzuerichsee.ch2.5Externe Schnittstellen2.5.1Datenbank2.5.1.1ERDDie bestehende Datenbank wird um die Tabelle BestellStatus ergänzt. Das ERD zeigt den Teil, der für die Verwaltung des Status relevant ist.2.5.1.2View der Teil-DB
4Bildungszentrum Zürichsee ∙Alte Landstrasse 40 ∙8810 Horgenhorgen@bzzuerichsee.ch ∙www.bzzuerichsee.ch3DB-ANBINDUNG MIT JAVAJava greift über die sog. JDBC1auf externe Datenquellen zu. Je nach Datenbank (Access, mySQL, Oracle ....) müssen entsprechende Treiber verfügbar sein.Für gewisse Produkte sind die Treiber im Umfang der Java SE enthalten, nicht aber für das Produkt Access. Hier müssen Libraries dem Projekt zugefügt werden.3.1JDBC für Access3.1.1TreiberMicrosoft stellt für Access keine Java-Unterstützung bereit. Somit ist man auf einen Drittanbieter angewiesen. Unter http://ucanaccess.sourceforge.net/site.htmlfindet sich eine Implementation unter Opensource-Lizenz.1.Laden Sie die Dateien von UCanAccessauf Ihren Rechner.3.1.2Einbinden in Projekt2.Entpacken Sie die ZIP-Datei auf Ihrem Rechner. Das Zielverzeichnis kann an beliebiger Stelle liegen.3.Erstellen Sie in Eclipse ein Java-Projekt.4.Binden Sie die die folgenden Libraries ins Projekt ein:•ucanaccess-3.0.5.jar•lib\commons-lang-2.6.jar•lib\commons-logging-1.1.1.jar•lib\hsqldb.jar•lib\jackcess-2.1.3.jarKlicken Sie dazu mit der rechten Maustaste auf das erstellte Projekt undwählen Sie das Menü BuildPath Add External Archives...5.Wählen Sie im Dialog das Verzeichnis aus, in das Sie die Treiber entzippt ha-ben. Fügen Sie die 5 genannten Datei zu.3.1.3JDBC-Verbindung codierenDie JavaSE liefert alle benötigten Funktionalitäten, um Datenbanken mittels SQL-Befehlen zu bearbeiten. Genau Details finden Sie in der API des Pakets java.sql.3.1.3.1Benötigte Paketeimportjava.sql.*;1Mehr zu JDBC findet sich unter https://de.wikipedia.org/wiki/Java_Database_Connectivity
5Bildungszentrum Zürichsee ∙Alte Landstrasse 40 ∙8810 Horgenhorgen@bzzuerichsee.ch ∙www.bzzuerichsee.ch3.1.3.2Benötigte ObjekteDie Verbindung zur Datenbank wird über ein Connection-Objekt realisiertprivateConnectionconn;3.1.3.3Datenbank verbindenFolgender Beispielcode zeigt, wie eine Datenbank über JDBC angebunden wird.try{// Datenbank über Connector verbindenClass.forName("net.ucanaccess.jdbc.UcanaccessDriver");conn=DriverManager.getConnection("jdbc:ucanaccess://"+ path);}catch(ClassNotFoundExceptionerr){// Die Teiber-Kalsse (hier UcanaccessDriver) ist nicht verfügbarSystem.out.println("Treiber kann nicht geladen werden");}catch(SQLExceptionerr){// Die Datenbank kann nicht kontaktiert werden.// (falscherName, falscher Pfad, falscher Treiber...)System.out.println("Verbindung kann nicht aufgebaut werden");}Wobei pathfür den (relativen)Verzeichnispfad zur Access-Datenbank des Projekts (CollShoes.accdb) steht.3.1.3.4Daten abfragenUm Daten auszulesen, muss zuerst ein Statement-Objekt erstellt und mit dem ent-sprechenden SQL-Befehl versehen werden. Das Ergebnis erscheint in einem ResultSet-Objekt, das dann ausgewertet werden kann.try{// Eine Abfrage an die Datenbank richtenStatementstmt = conn.createStatement();ResultSetrs = stmt.executeQuery("SELECT * FROM Kunde;");// die Anzahl der Einträge des Datensatzes lesenintcolumn= rs.getMetaData().getColumnCount();// Datensatz umd Datensatz abarbeitenwhile(rs.next()){for(inti=1; i<=column; i++)// Beginnt mit Position 1 !!!rs.getString(i);// hier erfolgt die Verarbeitung der Daten}rs.close();// nach Gebrauch sind des ResultSet...stmt.close(); // ...und das Statement zu schliessen.}catch(SQLExceptionerr){System.out.println("ungültiger SQL-Befehl");}3.1.3.5Daten schreibenDaten werden mittels einem Statement-Objekt in die Datenbank geschrieben.try{// Einen insert an die Datenbank richtenStatementstmt= conn.createStatement();stmt.execute("INSERT INTO Kunde (..., ..., ...) VALUES ('...', ..., '...');");stmt.close();catch(SQLExceptionerr){System.out.println("ungültiger SQL-Befehl");}